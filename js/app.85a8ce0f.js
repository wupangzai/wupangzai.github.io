(function(){var e={5358:function(e,t,s){var a={"./af":2190,"./af.js":2190,"./ar":7218,"./ar-dz":5785,"./ar-dz.js":5785,"./ar-kw":9417,"./ar-kw.js":9417,"./ar-ly":6904,"./ar-ly.js":6904,"./ar-ma":8617,"./ar-ma.js":8617,"./ar-ps":1318,"./ar-ps.js":1318,"./ar-sa":2699,"./ar-sa.js":2699,"./ar-tn":6789,"./ar-tn.js":6789,"./ar.js":7218,"./az":3050,"./az.js":3050,"./be":8316,"./be.js":8316,"./bg":310,"./bg.js":310,"./bm":8884,"./bm.js":8884,"./bn":3469,"./bn-bd":6672,"./bn-bd.js":6672,"./bn.js":3469,"./bo":9118,"./bo.js":9118,"./br":3113,"./br.js":3113,"./bs":3626,"./bs.js":3626,"./ca":921,"./ca.js":921,"./cs":7799,"./cs.js":7799,"./cv":2828,"./cv.js":2828,"./cy":3521,"./cy.js":3521,"./da":6962,"./da.js":6962,"./de":3294,"./de-at":6158,"./de-at.js":6158,"./de-ch":5960,"./de-ch.js":5960,"./de.js":3294,"./dv":7963,"./dv.js":7963,"./el":3432,"./el.js":3432,"./en-au":998,"./en-au.js":998,"./en-ca":5931,"./en-ca.js":5931,"./en-gb":5930,"./en-gb.js":5930,"./en-ie":8081,"./en-ie.js":8081,"./en-il":1594,"./en-il.js":1594,"./en-in":3904,"./en-in.js":3904,"./en-nz":1507,"./en-nz.js":1507,"./en-sg":9409,"./en-sg.js":9409,"./eo":2177,"./eo.js":2177,"./es":4805,"./es-do":9155,"./es-do.js":9155,"./es-mx":9791,"./es-mx.js":9791,"./es-us":6098,"./es-us.js":6098,"./es.js":4805,"./et":6240,"./et.js":6240,"./eu":391,"./eu.js":391,"./fa":612,"./fa.js":612,"./fi":4220,"./fi.js":4220,"./fil":5570,"./fil.js":5570,"./fo":5466,"./fo.js":5466,"./fr":4461,"./fr-ca":6306,"./fr-ca.js":6306,"./fr-ch":7081,"./fr-ch.js":7081,"./fr.js":4461,"./fy":3484,"./fy.js":3484,"./ga":6957,"./ga.js":6957,"./gd":2978,"./gd.js":2978,"./gl":9866,"./gl.js":9866,"./gom-deva":5011,"./gom-deva.js":5011,"./gom-latn":4724,"./gom-latn.js":4724,"./gu":1601,"./gu.js":1601,"./he":9802,"./he.js":9802,"./hi":9358,"./hi.js":9358,"./hr":3907,"./hr.js":3907,"./hu":218,"./hu.js":218,"./hy-am":533,"./hy-am.js":533,"./id":2844,"./id.js":2844,"./is":7353,"./is.js":7353,"./it":6364,"./it-ch":774,"./it-ch.js":774,"./it.js":6364,"./ja":6008,"./ja.js":6008,"./jv":8221,"./jv.js":8221,"./ka":2417,"./ka.js":2417,"./kk":4452,"./kk.js":4452,"./km":6149,"./km.js":6149,"./kn":4572,"./kn.js":4572,"./ko":659,"./ko.js":659,"./ku":6285,"./ku-kmr":9398,"./ku-kmr.js":9398,"./ku.js":6285,"./ky":1609,"./ky.js":1609,"./lb":119,"./lb.js":119,"./lo":1748,"./lo.js":1748,"./lt":1973,"./lt.js":1973,"./lv":1347,"./lv.js":1347,"./me":3023,"./me.js":3023,"./mi":5747,"./mi.js":5747,"./mk":4341,"./mk.js":4341,"./ml":3840,"./ml.js":3840,"./mn":2058,"./mn.js":2058,"./mr":9182,"./mr.js":9182,"./ms":5197,"./ms-my":9136,"./ms-my.js":9136,"./ms.js":5197,"./mt":6408,"./mt.js":6408,"./my":1683,"./my.js":1683,"./nb":3141,"./nb.js":3141,"./ne":9344,"./ne.js":9344,"./nl":4703,"./nl-be":4641,"./nl-be.js":4641,"./nl.js":4703,"./nn":9873,"./nn.js":9873,"./oc-lnc":1217,"./oc-lnc.js":1217,"./pa-in":4612,"./pa-in.js":4612,"./pl":4457,"./pl.js":4457,"./pt":1089,"./pt-br":9146,"./pt-br.js":9146,"./pt.js":1089,"./ro":5950,"./ro.js":5950,"./ru":7292,"./ru.js":7292,"./sd":6774,"./sd.js":6774,"./se":7493,"./se.js":7493,"./si":3761,"./si.js":3761,"./sk":9711,"./sk.js":9711,"./sl":8558,"./sl.js":8558,"./sq":8633,"./sq.js":8633,"./sr":688,"./sr-cyrl":7903,"./sr-cyrl.js":7903,"./sr.js":688,"./ss":1991,"./ss.js":1991,"./sv":7020,"./sv.js":7020,"./sw":5891,"./sw.js":5891,"./ta":3333,"./ta.js":3333,"./te":206,"./te.js":206,"./tet":4768,"./tet.js":4768,"./tg":8276,"./tg.js":8276,"./th":7977,"./th.js":7977,"./tk":6928,"./tk.js":6928,"./tl-ph":8046,"./tl-ph.js":8046,"./tlh":1361,"./tlh.js":1361,"./tr":4367,"./tr.js":4367,"./tzl":627,"./tzl.js":627,"./tzm":2636,"./tzm-latn":8148,"./tzm-latn.js":8148,"./tzm.js":2636,"./ug-cn":8823,"./ug-cn.js":8823,"./uk":461,"./uk.js":461,"./ur":1366,"./ur.js":1366,"./uz":3454,"./uz-latn":8374,"./uz-latn.js":8374,"./uz.js":3454,"./vi":8572,"./vi.js":8572,"./x-pseudo":464,"./x-pseudo.js":464,"./yo":3709,"./yo.js":3709,"./zh-cn":5873,"./zh-cn.js":5873,"./zh-hk":7549,"./zh-hk.js":7549,"./zh-mo":2240,"./zh-mo.js":2240,"./zh-tw":405,"./zh-tw.js":405};function n(e){var t=r(e);return s(t)}function r(e){if(!s.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=r,e.exports=n,n.id=5358},7337:function(e,t,s){"use strict";var a=s(6848),n=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},r=[],l={name:"App"},i=l,o=s(1656),c=(0,o.A)(i,n,r,!1,null,null,null),d=c.exports,u=s(9143),p=s.n(u),h=s(6178),m=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"class-home"}},[t("div",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.classList,expression:"classList"}],attrs:{id:"message"},domProps:{value:e.classList},on:{input:function(t){t.target.composing||(e.classList=t.target.value)}}}),t("el-button",{attrs:{type:"success"},on:{click:e.handler}},[e._v("下载课程表")]),t("el-tag",{staticStyle:{"margin-left":"10px"},attrs:{type:"danger"}},[e._v("不用再去MetaBase下载课表了呢，亲")]),t("el-link",{staticClass:"info",attrs:{type:"danger",disabled:""}},[e._v("叠个甲先，仅供参考")]),t("div",{staticClass:"wage"},[t("el-button",{attrs:{type:"primary",disabled:""},on:{click:e.toWagePage}},[e._v(" 绩效统计（disabled now） ")])],1),t("div",{staticClass:"daily-class",staticStyle:{"margin-top":"30px"}},[t("el-button",{attrs:{type:"danger"},on:{click:e.toDailyPage}},[e._v(" 日常课表 ")])],1),t("div",{staticClass:"daily-class",staticStyle:{"margin-top":"30px"}},[t("el-button",{attrs:{type:"info"},on:{click:e.toLessonRecordPage}},[e._v(" 课程反馈发送记录 ")])],1),t("h1",[e._v("伟大的性格，无需多言")])],1),e.tipsVisible?t("el-card",{staticClass:"box-card"},[e.count?t("h3",[e._v(" 总计有"),t("el-tag",[e._v(e._s(e.count))]),e._v("条课程 ")],1):e._e(),e.studentNotInRenGuang>0?t("h3",[e._v(" 其中 "),t("el-tag",{attrs:{type:"success"}},[e._v(e._s(e.count-e.studentNotInRenGuang))]),e._v(" 条课程在本校区上课，"),t("el-tag",{attrs:{type:"danger"}},[e._v(" "+e._s(e.studentNotInRenGuang))]),e._v("条课程不在半海人广,分别是 "),e._l(e.studentNotInRenGuangNameList,(function(s,a){return t("div",{key:a,staticClass:"not-in-place"},[t("el-tag",{attrs:{type:"danger"}},[e._v(e._s(`${s.time} - ${s.student} - ${s.subject}-${s.studentClassPlace}`))])],1)}))],2):e._e(),e.count>0&&e.studentNotInRenGuang<=0?t("h3",[e._v(" 所有学生都在半海人广校区上课"),t("i",{staticClass:"el-icon-success",staticStyle:{color:"green"}})]):e._e(),t("h3",[e._v(" 拥有两条课程以上的学生是： "),e._l(e.moreThanTwoClassStudentList,(function(s,a){return t("el-tag",{key:a,staticClass:"not-in-place"},[e._v(e._s(s[0].student))])}))],2)]):e._e(),e.tipsVisible?t("el-card",{staticClass:"box-card2"},[t("el-tag",{staticClass:"not-in-place",attrs:{type:"danger"}},[e._v("仅！供！参！考！记！得！二！次！确！认！！！")]),t("el-tag",{staticClass:"not-in-place",attrs:{type:"info"}},[e._v("下载的课表根据排课网站的JSON文件，字段自己挖的，如果那边开发改了则失效哦~")]),t("el-tag",{staticClass:"not-in-place",attrs:{type:"info"}},[e._v("下载的excel修改为按照排课表的顺序，方便一次复制全部，并且把助教映射上去了")]),t("el-tag",{staticClass:"not-in-place",attrs:{type:"info"}},[e._v("统计了一下上课校区不在半海人广的学生，并给出名单")]),t("el-tag",{staticClass:"not-in-place",attrs:{type:"info"}},[e._v("如果学生在当天不止一节课，excel中则把他们排在一起，并给出了学生名单")])],1):e._e()],1)},g=[],v=(s(4114),s(4603),s(7566),s(8721),s(2439)),y=s.n(v),f=s(788),C=s(8626),b=s.n(C),j=s(4373);const _="https://bi.innoclass.cn/api/public/card",x=_,A=5e3,B=j.A.create({baseURL:x,timeout:A});B.interceptors.request.use((e=>e),(e=>{})),B.interceptors.response.use((e=>e),(e=>{if(e&&e.response)switch(e.response.status){case 400:console.log("请求错误");break;case 401:console.log("未授权访问");break;default:console.log("其他错误信息")}return e}));var k=B,w={name:"App",components:{},data(){return{classList:"",personMap:[{name:"董洁",EName:"Jade"},{name:"王南飞",EName:"Winnie"},{name:"吴静",EName:"Wendy"},{name:"吴彬",EName:"Anan"},{name:"刘维倩",EName:"Quincy"},{name:"王淑贤",EName:"Yilia"},{name:"吴凡",EName:"吴凡"},{name:"许鹏",EName:"许鹏"}],count:0,studentNotInRenGuang:0,studentNotInRenGuangNameList:[],tipsVisible:!1,renderList:[],moreThanTwoList:[],jsonData:""}},methods:{handleListToExcel(e){return e.map(((e,t)=>({time:`${e.start.slice(-5)}-${e.end.slice(-5)}`,subject:e["课程"],teacher:e["教师"],student:e["学生/班级"],SA:this.personMap.find((t=>t.name===e["助教"]))?this.personMap.find((t=>t.name===e["助教"])).EName:"",todaySA:this.personMap.find((t=>t.name===e["助教"]))?this.personMap.find((t=>t.name===e["助教"])).EName:"",studentClassPlace:e["上课校区"],studentServePlace:e["学生服务校区"]})))},sortByPropertyOrder(e,t){const s=e.reduce(((e,s)=>{const a=s[t];return e[a]=e[a]||[],e[a].push(s),e}),{});return Object.keys(s).reduce(((e,t)=>e.concat(s[t])),[])},test(e){e.map(((e,t)=>({time:`${e.start.slice(-5)}-${e.end.slice(-5)}`,subject:e["课程"],teacher:e["教师"],student:e["学生/班级"],SA:this.personMap.find((t=>t.name===e["助教"]))?this.personMap.find((t=>t.name===e["助教"])).EName:"",todaySA:this.personMap.find((t=>t.name===e["助教"]))?this.personMap.find((t=>t.name===e["助教"])).EName:"",studentClassPlace:e["上课校区"]})))},handler(){this.classList?(this.tipsVisible=!0,this.exportToExcel()):this.$message.error("请输入课程-Json流格式")},groupedByProperty(e){return e.reduce(((e,t)=>{const s=t.student;return e[s]||(e[s]=[]),e[s].push(t),e}),{})},exportToExcel(){const e=JSON.parse(this.classList),t=this.handleListToExcel(e);t.forEach(((e,t)=>{"半海人广"!==e.studentClassPlace&&(this.studentNotInRenGuang++,this.studentNotInRenGuangNameList.push(e))}));const s=this.sortByPropertyOrder(t,"student");this.renderList=Object.values(this.groupedByProperty(s));const a=[["上课时间","科目","老师","学生","主带SA","今日SA","上课校区","补充说明"]];s.forEach(((e,t)=>{const s=e.SA?"":"非本校区学生--"+e.studentServePlace;a.push([e.time,e.subject,e.teacher,e.student,e.SA,e.todaySA,e.studentClassPlace,s])})),this.count=a.length-1;const n=y().utils.aoa_to_sheet(a);n["!cols"]=[{wch:20},{wch:30},{wch:15},{wch:15},{wch:15},{wch:15},{wch:15},{wch:30}];const r=Object.keys(n);r.pop(),r.pop(),r.forEach(((e,t)=>{n[e]&&(n[e].s={})}));const l=["A1","B1","C1","D1","E1","F1","G1","H1"];l.forEach((e=>{n[e].s.fill={fgColor:{rgb:"C6E0B4"}}})),r.forEach(((e,t)=>{n[e]&&(n[e].s.font={name:"宋体",sz:12})})),r.forEach(((e,t)=>{/^G/.test(e)&&"G1"!==e&&"半海人广"!==n[e].v&&(n[e].s.fill={fgColor:{rgb:"F56C6C"}})})),r.forEach(((e,t)=>{/^H/.test(e)&&"H1"!==e&&n[e].v&&(n[e].s.fill={fgColor:{rgb:"E6A23C"}})})),console.log(n);const i=y().utils.book_new();y().utils.book_append_sheet(i,n,"Sheet1");const o=y().write(i,{bookType:"xlsx",type:"array"}),c=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),d=window.URL.createObjectURL(c);(0,f.saveAs)(c,"Excel-课表转换.xlsx"),window.URL.revokeObjectURL(d),this.$message.success("下载中...请等待文件下载完成")},toWagePage(){this.$router.push("./wage")},toDailyPage(){this.$router.push("./daily-class")},toLessonRecordPage(){this.$router.push("./lesson-record")}},async created(){k.get("/422e5936-e3f1-4080-a226-e2311ab69019/query/json?parameters=%5B%7B%22type%22%3A%22category%22%2C%22value%22%3A%5B%22%E5%8D%8A%E6%B5%B7%E4%BA%BA%E5%B9%BF%22%5D%2C%22id%22%3A%22e7ab001d-adfb-44aa-7cd3-96ee5f8d0dc2%22%2C%22target%22%3A%5B%22variable%22%2C%5B%22template-tag%22%2C%22dept%22%5D%5D%7D%2C%7B%22type%22%3A%22date%2Fall-options%22%2C%22value%22%3A%22next1days%22%2C%22id%22%3A%22953e6c0e-7467-721c-8065-fa3451526c25%22%2C%22target%22%3A%5B%22dimension%22%2C%5B%22template-tag%22%2C%22date%22%5D%5D%7D%2C%7B%22type%22%3A%22category%22%2C%22value%22%3Anull%2C%22id%22%3A%22627547e3-e078-8cd7-1c44-0038eba685e3%22%2C%22target%22%3A%5B%22variable%22%2C%5B%22template-tag%22%2C%22stuName%22%5D%5D%7D%5D&format_rows=true").then((e=>{this.classList=JSON.stringify(e.data),this.$message.success("自动获取明日课表成功~")})).catch((e=>{console.error(e)}))},computed:{moreThanTwoClassStudentList(){return this.renderList.filter((e=>e.length>1))}}},S=w,N=(0,o.A)(S,m,g,!1,null,null,null),D=N.exports,O=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"wage"}},[t("div",{staticClass:"data-source"},[t("el-input",{staticClass:"wage-input",attrs:{placeholder:"MetaBase Input(a month)"},model:{value:e.metaBaseInput,callback:function(t){e.metaBaseInput=t},expression:"metaBaseInput"}}),t("el-input",{staticClass:"wage-input",staticStyle:{"margin-top":"30px"},attrs:{placeholder:"CA"},model:{value:e.CAName,callback:function(t){e.CAName=t},expression:"CAName"}}),t("el-input",{staticClass:"wage-input",staticStyle:{"margin-top":"30px"},attrs:{placeholder:"职级"},model:{value:e.level,callback:function(t){e.level=t},expression:"level"}}),t("el-button",{staticStyle:{"margin-top":"40px"},on:{click:e.clickFn}},[e._v("handler")])],1),t("div",{staticClass:"class-member"},[t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("自己的班课娃娃们")]),t("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"}},[e._v("Disabled")])],1),e._l(e.classMember[e.CAName],(function(s,a){return t("div",{key:a,staticClass:"text item"},[t("el-tag",[e._v(e._s(a))]),e._l(s,(function(s){return t("div",{key:s,staticStyle:{margin:"8px",color:"#666","font-size":"12px"}},[e._v(" "+e._s(s)+" ")])}))],2)}))],2)],1),t("div",{staticClass:"member-list"},[t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("奴役慰劳费")]),t("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"}},[e._v("Disabled")])],1),t("div",[t("div",[e._v(" VIP辅练总时长： "),t("el-tag",[e._v(e._s(e.VIPTotalHours))])],1),t("div",[e._v(" VIP课消统计： "),t("el-tag",{staticClass:"des-tag",attrs:{type:"danger"}},[e._v(e._s(1*e.VIPTotalHours*e.LevelMap[e.level]))])],1),t("div",{staticStyle:{"margin-top":"20px"}},[e._v(" 班课辅练总时长： "),t("el-tag",[e._v(e._s(e.classTotalHours))])],1),t("div",[e._v(" 班级课消统计： "),t("el-tag",{staticClass:"des-tag",attrs:{type:"danger"}},[e._v(e._s(.5*e.classTotalHours*e.LevelMap[e.level]))])],1)])])],1)])},L=[],E=s(9148),P=s.n(E),T={name:"Wage",data(){return{metaBaseInput:"",classMember:{"吴彬":{YSQ1TGRG24225:["赵雨斌","周骏杰","李广新","侯以凡","姚逸菲","许雪儿"],YSQ2QHRG24201U:["屈恺婷","彭梓坚","孙佩琪","虞博轩","强宇豪","韩浩天"]}},CAName:"",level:"",LevelMap:{P1:3,P2:4,P3:5},validDataList:[],VIPTotalHours:0,classTotalHours:0}},methods:{clickFn(){const e=JSON.parse(this.metaBaseInput);this.validDataList=e.map((e=>({CAName:e["助教"],stuOrClass:e["学生/班级"],date:P()(e["start"],"YYYY-MM-DD").format("YYYY-MM-DD"),duringHour:P().duration(P()(e.end).diff(P()(e.start))).asHours()}))),this.exportToExcel()},handleListToExcel(){const e=[];return this.validDataList.filter((e=>e.CAName===this.CAName)).map((t=>{const s={CAname:this.CAName,classDate:t.date,level:this.level,hourPrice:this.LevelMap[this.level],duringHour:t.duringHour},a=Object.keys(this.classMember[this.CAName]).includes(t.stuOrClass);a?this.classMember[this.CAName][t.stuOrClass].forEach((a=>{e.push({...s,stuType:"班级学员",stuName:a,classNo:t.stuOrClass,pricePay:.5*t.duringHour*this.LevelMap[this.level]}),this.classTotalHours+=t.duringHour})):(e.push({...s,stuType:"VIP学员",stuName:t.stuOrClass,classNo:"",pricePay:1*t.duringHour*this.LevelMap[this.level]}),this.VIPTotalHours+=t.duringHour)})),e},exportToExcel(){const e=this.handleListToExcel(),t=[["助教姓名","带教日期","学员类别","学生姓名","班级编号","职级","每小时服务奖金","授课课时","服务课消"]];e.forEach((e=>{t.push([e.CAname,e.classDate,e.stuType,e.stuName,e.classNo,e.level,e.hourPrice,e.duringHour,e.pricePay])}));const s=y().utils.aoa_to_sheet(t);s["!cols"]=[{wch:15},{wch:20},{wch:15},{wch:15},{wch:25},{wch:15},{wch:15},{wch:10}];const a=Object.keys(s);a.pop(),a.pop(),a.forEach(((e,t)=>{s[e]&&(s[e].s={})}));const n=["A1","B1","C1","D1","E1","F1","G1","H1","I1"];n.forEach((e=>{s[e].s.fill={fgColor:{rgb:"4BACC6"}},s[e].s.alignment={horizontal:"center",vertical:"center"},s[e].s.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})),a.forEach(((e,t)=>{s[e]&&(s[e].s.font={name:"宋体",sz:12})})),console.log(s);const r=y().utils.book_new();y().utils.book_append_sheet(r,s,"Sheet1");const l=y().write(r,{bookType:"xlsx",type:"array"}),i=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),o=window.URL.createObjectURL(i);(0,f.saveAs)(i,"Excel-课消统计.xlsx"),window.URL.revokeObjectURL(o),this.$message.success("下载中...请等待文件下载完成")}}},$=T,I=(0,o.A)($,O,L,!1,null,null,null),M=I.exports,Y=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"daily-class"}},[t("div",{staticClass:"data-source"},[t("el-input",{staticClass:"data-input",attrs:{placeholder:"MetaBase Data"},model:{value:e.metaBaseInput,callback:function(t){e.metaBaseInput=t},expression:"metaBaseInput"}}),t("div",{staticStyle:{"margin-top":"20px",width:"280px"}},[t("el-select",{staticStyle:{width:"280px"},attrs:{placeholder:"请选择"},model:{value:e.CAName,callback:function(t){e.CAName=t},expression:"CAName"}},e._l(e.options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary"},on:{click:e.clickFn}},[e._v(" 获取上课提醒 ")]),t("el-tag",{staticStyle:{"margin-left":"0px",display:"block"},attrs:{type:"warning"}},[e._v("不带教室，破系统没有数据,神仙都做不出来👆")]),t("div",{staticStyle:{"margin-right":"20px",width:"280px","margin-top":"50px"}},[t("el-tag",{attrs:{type:"danger"}},[e._v("带教室的 Pro Test Version👇 出错了别找我")]),t("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"https://jsonplaceholder.typicode.com/posts/","on-error":e.upload}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),t("em",[e._v("点击上传")])])])],1)],1),t("div",{staticClass:"copy-area"},[t("el-card",{staticClass:"box-card-daily"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("上课提醒")]),t("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"}},[e._v("操作按钮")])],1),t("div",{staticClass:"box-card-remind-container"},e._l(e.renderList,(function(s,a){return t("div",{key:a},[t("el-card",{staticClass:"box-card-remind"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(s.stuOrClass))]),t("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(t){return e.copyToClipBoard(s)}}},[e._v("复制✔")])],1),t("div",{staticClass:"copy-text"},[t("div",[e._v("☀【明日课程提醒】")]),t("div",[e._v("上课时间："+e._s(s.time))]),t("div",[e._v("上课科目："+e._s(s.subject)+"@"+e._s(s.teacher))]),t("div",[e._v("授课方式："+e._s(s.isOnline?"线上":"线下"))]),s.isOnline?e._e():t("div",[e._v(" 上课地址：半海人广校区（汉口路300号解放大厦4楼） ")]),s.isOnline?e._e():t("div",[e._v("上课教室："+e._s(s.classroom))]),t("div",[e._v("以上是明天的课程提醒，请查收哈🌹")])])])],1)})),0)])],1)])},R=[];s(6573),s(8100),s(7936),s(7467),s(4732),s(9577);const z=s(2439);var F={name:"DailyClass",data(){return{metaBaseInput:"",CAName:"吴彬",options:[{value:"吴彬",label:"吴彬"},{value:"王淑贤",label:"王淑贤"},{value:"刘维倩",label:"刘维倩"},{value:"董洁",label:"董洁"},{value:"王南飞",label:"王南飞"}],classMember:{"吴彬":{YSQ1TGRG24225:["赵雨斌","周骏杰","李广新","侯以凡","姚逸菲","许雪儿"],YSQ2QHRG24201U:["屈恺婷","彭梓坚","孙佩琪","虞博轩","强宇豪","韩浩天"]}},renderList:[],roomList:[]}},methods:{clickFn(){const e=JSON.parse(this.metaBaseInput),t=e.filter((e=>e["助教"]===this.CAName));console.log(t);const s=this.sortByPropertyOrder(t,"学生/班级");this.renderList=s.map((e=>({time:`${e.start.slice(-5)}-${e.end.slice(-5)}`,subject:e["课程"],stuOrClass:e["学生/班级"],teacher:e["教师"]})))},sortByPropertyOrder(e,t){const s=e.reduce(((e,s)=>{const a=s[t];return e[a]=e[a]||[],e[a].push(s),e}),{});return Object.keys(s).reduce(((e,t)=>e.concat(s[t])),[])},async copyToClipBoard(e){const t=`☀【明日课程提醒】\n上课时间：${e.time}\n上课科目：${e.subject}@${e.teacher}\n授课方式：${e.isOnline?"线上":"线下"}\n${e.isOnline?"":"上课地址：半海人广校区（汉口路300号解放大厦4楼）"}\n${e.isOnline?"":`上课教室：${e.classroom}`}\n以上是明天的课程提醒，请查收哈`;function s(e){if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(e);{let t=document.createElement("textarea");return t.value=e,t.style.position="absolute",t.style.opacity=0,t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select(),new Promise(((e,s)=>{document.execCommand("copy")?e():s(),t.remove()}))}}s(t),this.$message.success("复制成功")},upload(e,t){const s=new FileReader;s.readAsArrayBuffer(t.raw),s.onload=e=>{const t=new Uint8Array(e.target.result),s=z.read(t,{type:"array"}),a=P()().add(1,"days").format("YYYY.M.D"),n=s.Sheets[a],r=z.utils.sheet_to_json(n);console.log("jsonData",r),this.roomList=b().cloneDeep(r);for(let c=5;c<r.length;c++){const e=Object.keys(r[c]);e.includes("半海人广校区教室占用表")||(this.roomList[c]["半海人广校区教室占用表"]=this.roomList[c-1]["半海人广校区教室占用表"])}for(let c=4;c<r.length;c++){const e=Object.keys(r[c]);e.includes("__EMPTY_6")||(this.roomList[c]["__EMPTY_6"]=this.roomList[c-1]["__EMPTY_6"])}console.log("translate roomList",this.roomList);const l=JSON.parse(this.metaBaseInput),i=l.filter((e=>e["助教"]===this.CAName)),o=this.sortByPropertyOrder(i,"学生/班级");this.renderList=o.map((e=>{let t,s;return this.roomList.forEach(((a,n)=>{const r=`${e.start.slice(-5)}-${e.end.slice(-5)}`===a["__EMPTY"]&&e["学生/班级"]===a["__EMPTY_3"],l=`${e.start.slice(-5)}-${e.end.slice(-5)}`===a["__EMPTY_7"]&&a["__EMPTY_10"]===e["学生/班级"];r?t=a["半海人广校区教室占用表"]:l&&(t=a["__EMPTY_6"]),r&&"网课"===t&&(s=!0)})),{time:`${e.start.slice(-5)}-${e.end.slice(-5)}`,subject:e["课程"],stuOrClass:e["学生/班级"],teacher:e["教师"],classroom:t,isOnline:s}})),console.log(this.renderList)}}},async created(){k.get("/422e5936-e3f1-4080-a226-e2311ab69019/query/json?parameters=%5B%7B%22type%22%3A%22category%22%2C%22value%22%3A%5B%22%E5%8D%8A%E6%B5%B7%E4%BA%BA%E5%B9%BF%22%5D%2C%22id%22%3A%22e7ab001d-adfb-44aa-7cd3-96ee5f8d0dc2%22%2C%22target%22%3A%5B%22variable%22%2C%5B%22template-tag%22%2C%22dept%22%5D%5D%7D%2C%7B%22type%22%3A%22date%2Fall-options%22%2C%22value%22%3A%22next1days%22%2C%22id%22%3A%22953e6c0e-7467-721c-8065-fa3451526c25%22%2C%22target%22%3A%5B%22dimension%22%2C%5B%22template-tag%22%2C%22date%22%5D%5D%7D%2C%7B%22type%22%3A%22category%22%2C%22value%22%3Anull%2C%22id%22%3A%22627547e3-e078-8cd7-1c44-0038eba685e3%22%2C%22target%22%3A%5B%22variable%22%2C%5B%22template-tag%22%2C%22stuName%22%5D%5D%7D%5D&format_rows=true").then((e=>{console.log("[ 111 ] >",e),this.metaBaseInput=JSON.stringify(e.data),this.$message.success("自动获取明日课表成功~")})).catch((e=>{console.error(e)}))}},H=F,G=(0,o.A)(H,Y,R,!1,null,null,null),J=G.exports,U=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"less-record"}},[t("div",[t("el-input",{staticClass:"data-input",attrs:{placeholder:"MetaBase Data"},model:{value:e.metaBaseInput,callback:function(t){e.metaBaseInput=t},expression:"metaBaseInput"}}),t("div",{staticStyle:{"margin-top":"20px",width:"280px"}},[t("el-select",{staticStyle:{width:"280px"},attrs:{placeholder:"请选择"},on:{change:e.changeCA},model:{value:e.CAName,callback:function(t){e.CAName=t},expression:"CAName"}},e._l(e.options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-button",{staticStyle:{"margin-top":"20px",width:"120px"},attrs:{type:"primary"},on:{click:e.clickFn}},[e._v("查询")])],1),t("div",{staticClass:"student-list"},[t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("昨日课程反馈记录")]),t("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"}},[e._v("真的服了")])],1),e._l(e.renderList[e.yesterday],(function(s,a){return t("div",{key:a,staticClass:"text item",staticStyle:{"margin-top":"20px"}},[t("el-checkbox",{on:{change:e.changeCheckBox},model:{value:s.isSend,callback:function(t){e.$set(s,"isSend",t)},expression:"record.isSend"}},[t("el-tag",[e._v(e._s(s.time)+" "),t("span",{staticStyle:{"margin-left":"10px"}},[e._v(" "+e._s(s.stuOrClass)+" ")])])],1)],1)}))],2)],1),t("div",{staticClass:"student-list"},[t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("今日课程反馈记录")]),t("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"}},[e._v("真的服了")])],1),e._l(e.renderList[e.today],(function(s,a){return t("div",{key:a,staticClass:"text item",staticStyle:{"margin-top":"20px"}},[t("el-checkbox",{on:{change:e.changeCheckBox},model:{value:s.isSend,callback:function(t){e.$set(s,"isSend",t)},expression:"record.isSend"}},[t("el-tag",{attrs:{type:"warning"}},[e._v(e._s(s.time)+" "),t("span",{staticStyle:{"margin-left":"10px"}},[e._v(" "+e._s(s.stuOrClass)+" ")])])],1)],1)}))],2)],1)])},V=[],q={name:"LessRecord",data(){return{token_type:"Bearer",access_token:"",CAName:"吴彬",metaBaseInput:"",today:"",yesterday:"",options:[{value:"吴彬",label:"吴彬"},{value:"王淑贤",label:"王淑贤"},{value:"刘维倩",label:"刘维倩"},{value:"董洁",label:"董洁"},{value:"王南飞",label:"王南飞"}],lessonRecordList:[],lessonNextRecordList:[],metaBaseTodayInput:"",renderList:{}}},methods:{login(){const e={org_id:5,username:"13226212172",password:"wb524920."};k({method:"post",url:"/crm/pub/login",data:e}).then((e=>{this.access_token=e.data.access_token,localStorage.setItem("access_token",this.access_token),console.log(this.access_token)}))},test(){k({method:"get",url:"/crm/course-schedulings",data:{queryValue:"施涵奕",page:1,per_page:15},headers:{Authorization:`Bearer ${this.access_token}`}}).then((e=>{console.log("test",e)}))},sortByPropertyOrder(e,t){const s=e.reduce(((e,s)=>{const a=s[t];return e[a]=e[a]||[],e[a].push(s),e}),{});return Object.keys(s).reduce(((e,t)=>e.concat(s[t])),[])},clickFn(){const e=JSON.parse(this.metaBaseInput),t=JSON.parse(this.metaBaseTodayInput),s=e.filter((e=>e["助教"]===this.CAName)),a=t.filter((e=>e["助教"]===this.CAName)),n=this.sortByPropertyOrder(s,"学生/班级"),r=this.sortByPropertyOrder(a,"学生/班级");this.today=P()().format("YYYY-MM-DD"),this.yesterday=P()().subtract(1,"days").format("YYYY-MM-DD");const l=n.map((e=>({time:`${e.start.slice(-5)}-${e.end.slice(-5)}`,subject:e["课程"],stuOrClass:e["学生/班级"],teacher:e["教师"],isSend:!!e["isSend"]}))),i=r.map((e=>({time:`${e.start.slice(-5)}-${e.end.slice(-5)}`,subject:e["课程"],stuOrClass:e["学生/班级"],teacher:e["教师"],isSend:!!e["isSend"]})));if(localStorage.getItem(`${this.CAName}lesson-course`)){const e=JSON.parse(localStorage.getItem(`${this.CAName}lesson-course`));this.renderList={[this.yesterday]:e[this.yesterday]??l,[this.today]:e[this.today]??i},localStorage.setItem(`${this.CAName}lesson-course`,JSON.stringify(this.renderList)),console.log("this.renderList",this.renderList)}else this.renderList={[this.yesterday]:l,[this.today]:i},localStorage.setItem(`${this.CAName}lesson-course`,JSON.stringify(this.renderList))},async getRecord(){const e=await k.get("/422e5936-e3f1-4080-a226-e2311ab69019/query/json?parameters=%5B%7B%22type%22%3A%22category%22%2C%22value%22%3A%5B%22%E5%8D%8A%E6%B5%B7%E4%BA%BA%E5%B9%BF%22%5D%2C%22id%22%3A%22e7ab001d-adfb-44aa-7cd3-96ee5f8d0dc2%22%2C%22target%22%3A%5B%22variable%22%2C%5B%22template-tag%22%2C%22dept%22%5D%5D%7D%2C%7B%22type%22%3A%22date%2Fall-options%22%2C%22value%22%3A%22past1days%22%2C%22id%22%3A%22953e6c0e-7467-721c-8065-fa3451526c25%22%2C%22target%22%3A%5B%22dimension%22%2C%5B%22template-tag%22%2C%22date%22%5D%5D%7D%2C%7B%22type%22%3A%22category%22%2C%22value%22%3Anull%2C%22id%22%3A%22627547e3-e078-8cd7-1c44-0038eba685e3%22%2C%22target%22%3A%5B%22variable%22%2C%5B%22template-tag%22%2C%22stuName%22%5D%5D%7D%5D&format_rows=true"),t=await k.get("/422e5936-e3f1-4080-a226-e2311ab69019/query/json?parameters=%5B%7B%22type%22%3A%22category%22%2C%22value%22%3A%5B%22%E5%8D%8A%E6%B5%B7%E4%BA%BA%E5%B9%BF%22%5D%2C%22id%22%3A%22e7ab001d-adfb-44aa-7cd3-96ee5f8d0dc2%22%2C%22target%22%3A%5B%22variable%22%2C%5B%22template-tag%22%2C%22dept%22%5D%5D%7D%2C%7B%22type%22%3A%22date%2Fall-options%22%2C%22value%22%3A%22thisday%22%2C%22id%22%3A%22953e6c0e-7467-721c-8065-fa3451526c25%22%2C%22target%22%3A%5B%22dimension%22%2C%5B%22template-tag%22%2C%22date%22%5D%5D%7D%2C%7B%22type%22%3A%22category%22%2C%22value%22%3Anull%2C%22id%22%3A%22627547e3-e078-8cd7-1c44-0038eba685e3%22%2C%22target%22%3A%5B%22variable%22%2C%5B%22template-tag%22%2C%22stuName%22%5D%5D%7D%5D&format_rows=true");this.metaBaseInput=JSON.stringify(e.data),this.metaBaseTodayInput=JSON.stringify(t.data),this.$message.success("自动获取昨日、今日课表成功~"),this.clickFn()},changeCheckBox(){localStorage.setItem(`${this.CAName}lesson-course`,JSON.stringify(this.renderList))},changeCA(){this.getRecord()}},async created(){await this.getRecord()}},Q=q,W=(0,o.A)(Q,U,V,!1,null,"be771640",null),K=W.exports;const X=[{path:"/",component:D},{path:"/wage",component:M},{path:"/daily-class",component:J},{path:"/lesson-record",component:K}],Z=new h.A({routes:X});var ee=Z;a["default"].use(h.A),a["default"].config.productionTip=!1,a["default"].use(p()),new a["default"]({router:ee,render:e=>e(d)}).$mount("#app")},1976:function(){},1581:function(){}},t={};function s(a){var n=t[a];if(void 0!==n)return n.exports;var r=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(r.exports,r,r.exports,s),r.loaded=!0,r.exports}s.m=e,function(){s.amdO={}}(),function(){var e=[];s.O=function(t,a,n,r){if(!a){var l=1/0;for(d=0;d<e.length;d++){a=e[d][0],n=e[d][1],r=e[d][2];for(var i=!0,o=0;o<a.length;o++)(!1&r||l>=r)&&Object.keys(s.O).every((function(e){return s.O[e](a[o])}))?a.splice(o--,1):(i=!1,r<l&&(l=r));if(i){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[a,n,r]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){s.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,a){var n,r,l=a[0],i=a[1],o=a[2],c=0;if(l.some((function(t){return 0!==e[t]}))){for(n in i)s.o(i,n)&&(s.m[n]=i[n]);if(o)var d=o(s)}for(t&&t(a);c<l.length;c++)r=l[c],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(d)},a=self["webpackChunkclass_demo"]=self["webpackChunkclass_demo"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=s.O(void 0,[504],(function(){return s(7337)}));a=s.O(a)})();
//# sourceMappingURL=app.85a8ce0f.js.map